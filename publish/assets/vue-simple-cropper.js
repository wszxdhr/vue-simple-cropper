!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VueSimpleCropper=e():t.VueSimpleCropper=e()}(this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,o){"use strict";function i(t){o(6)}var n=o(5),r=o(8),h=o(7),a=i,s=h(n.a,r.a,a,null,null);e.a=s.exports},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(0);e.default=i.a},function(t,e,o){"use strict";e.a=function(t){var e=t.image,o=t.width,i=t.height,n=t.left,r=t.top,h=t.iWidth,a=t.iHeight,s=t.rotate,u=t.type,f=t.callback,c=new Image;c.setAttribute("crossOrigin","anonymous");var m=document.createElement("canvas");m.width=o,m.height=i;var d=null;d=m.getContext("2d"),d.save(),c.onload=function(){d.translate(n+h/2,r+a/2),d.rotate(s*Math.PI/180),d.translate(-(n+h/2),-(r+a/2)),d.drawImage(c,n,r,h,a),d.restore(),f(m.toDataURL(u||"image/png"))},c.src=e.src}},function(t,e,o){"use strict";e.a={left:0,right:0,bottom:100,top:100,parent:null,ratioLocked:!1,changeLeft:function(t){var e=t>0?t:0;if(this.ratioLocked&&this.parent){var o=this.parent.getBoundingClientRect(),i=o.width-this.left-this.right,n=o.height-this.top-i;if(n<0){n=0;var r=o.height-this.top;e=o.width-r-this.right}this.bottom=n}this.left=e},changeRight:function(t){this.right=t},changeBottom:function(t){this.bottom=t},changeTop:function(t){this.top=t},setRatioLocked:function(t,e){if(this.ratioLocked=t,t){var o=this.w,i=this.h,n=o/i;e&&(e.ratio?n=e.ratio:e.w&&e.h&&(n=e.w/e.h,o=e.w,i=e.h)),this.w=o,this.h=o/n}},setRect:function(t){var e=t.left,o=t.bottom,i=t.right,n=t.top;void 0!==e&&null!==e&&(this.left=e),void 0!==o&&null!==o&&(this.bottom=o),void 0!==i&&null!==i&&(this.right=i),void 0!==n&&null!==n&&(this.top=n)}}},function(t,e,o){"use strict";e.a=function(t){var e=t.outerHeight,o=t.outerWidth,i=t.innerHeight,n=t.innerWidth,r=t.rotate,h=(t.offsetX,t.offsetY,90===r||270===r),a=h?e:o,s=h?o:e,u=n/i,f=a/s,c=0,m=0;return u>f?(c=a,m=c/u):(m=s,c=m*u),{height:m,width:c,top:(e-m)/2,left:(o-c)/2}}},function(t,e,o){"use strict";var i=o(3),n=o(4),r=o(2);e.a={props:{image:{type:String,default:""},infoBase:{type:String,default:"marquee"},ratio:{type:Number,default:0},rotate:{type:Number,default:0}},created:function(){this.marquee.parent=this.$refs.cropper},mounted:function(){console.dir(this.$refs.cropper),this.imageChanged()},data:function(){return{marquee:i.a,imageInfo:{x:0,y:0,w:100,h:100,naturalWidth:0,naturalHeight:0},touchInfo:{x1:0,x2:0,y1:0,y2:0,dotIndex:0,marqueeOld:{left:0,right:0,bottom:0,top:0},isMoving:!1}}},methods:{onMarqueeMouseDown:function(t){console.log("down"),console.dir(t),this.touchInfo.x1=t.clientX,this.touchInfo.y1=t.clientY,this.touchInfo.marqueeOld.left=this.marquee.left,this.touchInfo.marqueeOld.bottom=this.marquee.bottom,this.touchInfo.marqueeOld.right=this.marquee.right,this.touchInfo.marqueeOld.top=this.marquee.top,this.touchInfo.isMoving=!0,document.body.addEventListener("mousemove",this.onMarqueeMouseMove),document.body.addEventListener("mouseup",this.onMarqueeMouseUp)},onMarqueeMouseMove:function(t){this.touchInfo.x2=t.clientX,this.touchInfo.y2=t.clientY;var e=this.$refs.cropper.getBoundingClientRect(),o=e.width-this.touchInfo.marqueeOld.left-this.touchInfo.marqueeOld.right,i=e.height-this.touchInfo.marqueeOld.top-this.touchInfo.marqueeOld.bottom,n=this.touchInfo.marqueeOld.left+this.touchInfo.x2-this.touchInfo.x1,r=this.touchInfo.marqueeOld.right-(this.touchInfo.x2-this.touchInfo.x1),h=this.touchInfo.marqueeOld.top+this.touchInfo.y2-this.touchInfo.y1,a=this.touchInfo.marqueeOld.bottom-(this.touchInfo.y2-this.touchInfo.y1);n<=0?(n=0,r=e.width-o):r<=0&&(r=0,n=e.width-o),h<=0?(h=0,a=e.height-i):a<=0&&(a=0,h=e.height-i),this.marquee.setRect({left:n,right:r,top:h,bottom:a}),this.computeInfo()},onMarqueeMouseUp:function(t){this.touchInfo.isMoving=!1,document.body.removeEventListener("mousemove",this.onMarqueeMouseMove),document.body.removeEventListener("mouseup",this.onMarqueeMouseUp)},onMarqueeDotMouseDown:function(t,e){this.touchInfo.x1=t.clientX,this.touchInfo.y1=t.clientY,this.touchInfo.marqueeOld.left=this.marquee.left,this.touchInfo.marqueeOld.bottom=this.marquee.bottom,this.touchInfo.marqueeOld.right=this.marquee.right,this.touchInfo.marqueeOld.top=this.marquee.top,this.touchInfo.isMoving=!0,this.touchInfo.dotIndex=e,document.body.addEventListener("mousemove",this.onMarqueeDotMouseMove),document.body.addEventListener("mouseup",this.onMarqueeDotMouseUp)},onMarqueeDotMouseMove:function(t){var e=this;this.touchInfo.x2=t.clientX,this.touchInfo.y2=t.clientY;var o=this.$refs.cropper.getBoundingClientRect(),i=this.touchInfo.x2-this.touchInfo.x1,n=this.touchInfo.y2-this.touchInfo.y1,r=this.touchInfo.marqueeOld.top,h=this.touchInfo.marqueeOld.bottom,a=this.touchInfo.marqueeOld.left,s=this.touchInfo.marqueeOld.right,u=function(t){e.ratio?i=n*e.ratio:t&&(i=0)},f=function(t){e.ratio?n=i/e.ratio:t&&(n=0)},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;r=e.touchInfo.marqueeOld.top+t},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;a=e.touchInfo.marqueeOld.left+t},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;h=e.touchInfo.marqueeOld.bottom+t},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;s=e.touchInfo.marqueeOld.right+t};switch(this.touchInfo.dotIndex){case 1:u(),c(),m();break;case 2:u(!0),c(),g();break;case 3:u(),c(),g();break;case 4:f(!0),m(),d();break;case 5:f(!0),g(-i),d(-n);break;case 6:u(),d(-n),m(-i);break;case 7:u(!0),d(-n),g(-i);break;case 8:u(),g(-i),d(-n)}r<=0&&(r=0,this.ratio&&(console.log((o.height-h)*this.ratio),a===this.marquee.left?s=o.width-(o.height-h)*this.ratio-a:a=o.width-(o.height-h)*this.ratio-s)),h<=0&&(h=0,this.ratio&&(a===this.marquee.left?s=o.width-(o.height-r)*this.ratio-a:a=o.width-(o.height-r)*this.ratio-s)),a<=0&&(a=0,this.ratio&&(r===this.marquee.top?h=o.height-(o.width-s)/this.ratio-r:r=o.height-(o.width-s)/this.ratio-h)),s<=0&&(s=0,this.ratio&&(r===this.marquee.top?h=o.height-(o.width-a)/this.ratio-r:r=o.height-(o.width-a)/this.ratio-h)),this.marquee.setRect({left:a,right:s,top:r,bottom:h}),this.computeInfo()},onMarqueeDotMouseUp:function(t){this.touchInfo.isMoving=!1,document.body.removeEventListener("mousemove",this.onMarqueeDotMouseMove),document.body.removeEventListener("mouseup",this.onMarqueeDotMouseUp)},setImage:function(){this.imageInfo.naturalWidth=this.$refs["cropper-image"].naturalWidth,this.imageInfo.naturalHeight=this.$refs["cropper-image"].naturalHeight;var t=this.$refs.cropper.clientWidth,e=this.$refs.cropper.clientHeight,i=o.i(n.a)({outerHeight:e,outerWidth:t,innerHeight:this.imageInfo.naturalHeight,innerWidth:this.imageInfo.naturalWidth,rotate:this.rotate}),r=i.left,h=i.top,a=i.width,s=i.height;this.imageInfo.y=h,this.imageInfo.x=r,this.imageInfo.w=a,this.imageInfo.h=s;var u=this.imageInfo.y,f=this.imageInfo.x,c=e-this.imageInfo.y-this.imageInfo.h,m=t-this.imageInfo.x-this.imageInfo.w,d=this.imageInfo.w,g=this.imageInfo.h;if(this.ratio)if(d>g*this.ratio){var l=this.imageInfo.w/2+this.imageInfo.x,p=g*this.ratio/2;m=f=l-p,console.log(m)}else{var I=this.imageInfo.h/2+this.imageInfo.y,v=d/this.ratio/2;c=u=I-v}this.marquee.changeLeft(f),this.marquee.changeTop(u),this.marquee.changeBottom(c),this.marquee.changeRight(m),this.computeInfo()},imageChanged:function(){var t=this;this.$refs["cropper-image"].onload=function(){t.setImage()}},computeInfo:function(){var t=this,e=this.$refs.cropper.getBoundingClientRect(),o={},i=function(){return{x:t.marquee.left-t.imageInfo.x,y:t.marquee.top-t.imageInfo.y,w:e.width-t.marquee.left-t.marquee.right,h:e.height-t.marquee.top-t.marquee.bottom,rotate:t.rotate+"deg",src:t.image}},n=function(){return{x:t.imageInfo.x-t.marquee.left,y:t.imageInfo.y-t.marquee.top,w:e.width-t.marquee.left-t.marquee.right,h:e.height-t.marquee.top-t.marquee.bottom,rotate:t.rotate+"deg",src:t.image,image:{w:t.imageInfo.w,h:t.imageInfo.h,rotate:"0deg"}}};"image"===this.infoBase?o=i():"marquee"===this.infoBase?o=n():"both"===this.infoBase&&(o={image:i(),marquee:n()}),this.$emit("changed",o)},getImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",i=this.$refs.cropper.getBoundingClientRect();return o.i(r.a)({callback:t,rotate:this.rotate,type:e,width:i.width-this.marquee.left-this.marquee.right,height:i.height-this.marquee.top-this.marquee.bottom,left:this.imageInfo.x-this.marquee.left,top:this.imageInfo.y-this.marquee.top,iWidth:this.imageInfo.w,iHeight:this.imageInfo.h,image:this.$refs["cropper-image"]})}},watch:{image:function(t){this.imageChanged()},rotate:function(){this.setImage()}}}},function(t,e){},function(t,e){t.exports=function(t,e,o,i,n){var r,h=t=t||{},a=typeof t.default;"object"!==a&&"function"!==a||(r=t,h=t.default);var s="function"==typeof h?h.options:h;e&&(s.render=e.render,s.staticRenderFns=e.staticRenderFns),i&&(s._scopeId=i);var u;if(n?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},s._ssrRegister=u):o&&(u=o),u){var f=s.functional,c=f?s.render:s.beforeCreate;f?s.render=function(t,e){return u.call(e),c(t,e)}:s.beforeCreate=c?[].concat(c,u):[u]}return{esModule:r,exports:h,options:s}}},function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"cropper",staticClass:"vue-simple-cropper"},[o("img",{ref:"cropper-image",class:["vue-simple-cropper-image"],style:{width:t.imageInfo.w+"px",height:t.imageInfo.h+"px",top:t.imageInfo.y+"px",left:t.imageInfo.x+"px",transform:"rotate("+t.rotate+"deg)"},attrs:{src:t.image,alt:""}}),t._v(" "),o("div",{staticClass:"vue-simple-cropper-marquee",style:{right:t.marquee.right+"px",bottom:t.marquee.bottom+"px",top:t.marquee.top+"px",left:t.marquee.left+"px"}},[o("div",{staticClass:"vue-simple-cropper-marque-wrap"},[o("div",{staticClass:"vue-simple-cropper-marque-mask",on:{mousedown:function(e){t.onMarqueeMouseDown(e)}}}),t._v(" "),t._l(8,function(e){return o("div",{class:["vue-simple-cropper-marque-dot","dot"+e],on:{mousedown:function(o){t.onMarqueeDotMouseDown(o,e)}}})})],2)])])},n=[],r={render:i,staticRenderFns:n};e.a=r}])});
//# sourceMappingURL=vue-simple-cropper.js.map